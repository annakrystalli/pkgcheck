# pkgreport

<!-- badges: start -->
[![R build status](https://github.com/mpadge/pkgreport/workflows/R-CMD-check/badge.svg)](https://github.com/mpadge/pkgreport/actions)
[![Travis build status](https://travis-ci.org/mpadge/pkgreport?branch=master)](https://travis-ci.org/mpadge/pkgreport)
[![Project Status: Concept](https://www.repostatus.org/badges/latest/concept.svg)](https://www.repostatus.org/#concept)
<!-- badges: end -->

Plumber API to report on package structure and function. Uses functionality
provided by the [`r-lib/pkgapi` package](https://github.com/r-lib/pkgapi),
which is not on CRAN and must first be installed with
```{r pkgapi, eval = FALSE}
source("https://install-github.me/r-lib/pkgapi")
```
(or `remotes::install_github()` will also work).

```{r load, echo = FALSE, message = FALSE}
devtools::load_all (".", export_all = FALSE)
```
```{r load-fakey, eval = FALSE}
library (pkgreport)
```



## Usage

Set up a local host at specified port, currently only configured to serve on `localhost`:

```{r serve}
port <- 8000
ps <- serve_api (port = port)
```
The returned object, `ps`, is a [`processx`](https://github.com/r-lib/processx)
object identifying a background R process hosting the local API. This process
must be manually killed once finished, as demonstrated below.

A specified repository can then be locally downloaded with the `pr_dl()`
function, and a corresponding report on the software generated with
`pr_report()`:

```{r demo-fakey, eval = FALSE}
u <- "https://github.com/ropensci/osmdata"
res <- pr_report (u, port = port)
res
```
```{r demo, echo = FALSE}
#saveRDS (res, "res.Rds")
readRDS ("res.Rds")
```


Finally, kill the `processx` process hosting the local API:
```{r kill}
ps
chk <- ps$kill()
ps
```


