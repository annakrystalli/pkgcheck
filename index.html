<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>rOpenSci Package Checks • pkgcheck</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="rOpenSci Package Checks">
<meta property="og:description" content="Check whether a package is ready for submission to rOpenSci’s
    peer review system.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">pkgcheck</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1.284</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ropenscilabs/pkgcheck/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="pkgcheck" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#pkgcheck" class="anchor" aria-hidden="true"></a>pkgcheck</h1></div>
<!-- badges: start -->

<p>Check whether a package is ready for submission to <a href="https://ropensci.org" class="external-link">rOpenSci</a>’s peer review system. The primary function collates the output of <a href="https://github.com/mangothecat/goodpractice" class="external-link"><code>goodpractice</code></a>, including <code>R CMD check</code> results, along with a number of statistics via the <a href="https://github.com/ropenscilabs/pkgstats" class="external-link"><code>pkgstats</code> package</a>, and package structure checks expected for rOpenSci submissions. The output of this function immediately indicates whether or not a package is “Ready to Submit”.</p>
<p>Installation of the <a href="https://github.com/ropenscilabs/pkgstats" class="external-link"><code>pkgstats</code> package</a> also requires both <a href="https://ctags.io" class="external-link"><code>ctags</code></a> and <a href="https://www.gnu.org/software/global/" class="external-link">GNU <code>global</code></a> to be installed. See package description and those links for how to install those libraries on your system. This package also uses the <a href="https://developer.github.com/v4" class="external-link">github GraphQL API</a> which requires a local GitHub token to be stored with an unambiguous name including <code>GITHUB</code>, such as <code>GITHUB_TOKEN</code> (recommended), or <code>GITHUB_PAT</code> (for Personal Authorization Token). This can be obtained from GitHub (via your user settings), and stored using</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.setenv</a></span><span class="op">(</span><span class="st">"GITHUB_TOKEN"</span> <span class="op">=</span> <span class="st">"&lt;my_token&gt;"</span><span class="op">)</span></code></pre></div>
<p>This can also be set permanently by putting this line in your <code>~/.Renviron</code> file (or creating this if it does not yet exist). Once <code>pkgstats</code> has been successfully installed, the <code>pkgcheck</code> package can then be loaded via a <code>library</code> call:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ropenscilabs/pkgcheck" class="external-link">pkgcheck</a></span><span class="op">)</span></code></pre></div>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor" aria-hidden="true"></a>Usage</h2>
<p>The package primarily has one function, <code>pkgcheck</code>, which accepts the single argument, <code>path</code>, specifying the local location of a git repository to be analysed. The following code generates a reproducible report by first downloading a local clone of a repository called <a href="https://github.com/mpadge/srr-demo" class="external-link"><code>srr-demo</code></a>, which contains the skeleton of an <a href="https://github.com/ropenscilabs/srr" class="external-link"><code>srr</code> (Software Review Roclets) package</a>, generated with the <a href="https://ropenscilabs.github.io/srr/reference/srr_stats_pkg_skeleton.html" class="external-link"><code>srr_stats_pkg_skeleton()</code> function</a>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span> <span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/gert/" class="external-link">gert</a></span><span class="op">)</span>
<span class="va">mydir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span> <span class="op">(</span><span class="op">)</span>, <span class="st">"srr-demo"</span><span class="op">)</span>
<span class="fu"><a href="https://docs.ropensci.org/gert/reference/git_fetch.html" class="external-link">git_clone</a></span> <span class="op">(</span><span class="st">"https://github.com/mpadge/srr-demo"</span>, path <span class="op">=</span> <span class="va">mydir</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/pkgcheck.html">pkgcheck</a></span> <span class="op">(</span><span class="va">mydir</span><span class="op">)</span></code></pre></div>
<p>That object has default <code>print</code> and <code>summary</code> methods. The latter can be used to simply check whether a package is ready for submission:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span> <span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">## ── demo 0.0.0.9000 ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span>
<span class="co">## </span>
<span class="co">## ✔ Package uses 'roxygen2'</span>
<span class="co">## ✖ Package does not have a 'contributing.md' file</span>
<span class="co">## ✔ All functions have examples</span>
<span class="co">## ✔ Package 'DESCRIPTION' has a URL field</span>
<span class="co">## ✖ Package 'DESCRIPTION' does not have a BugReports field</span>
<span class="co">## ✖ Package has no continuous integration checks</span>
<span class="co">## ✖ Package coverage is 0% (should be at least 75%)</span>
<span class="co">## ✔ R CMD check found no errors</span>
<span class="co">## ✔ R CMD check found no warnings</span>
<span class="co">## ✔ All applicable standards have been documented in this package</span>
<span class="co">## </span>
<span class="co">## ℹ Current status:</span>
<span class="co">## ✖ This package is not ready to be submitted</span>
<span class="co">## </span></code></pre></div>
<p>A package may only be submitted when the summary contains all ticks and no cross symbols. (These symbols are colour-coded when generated in a terminal; GitHub markdown only renders them in black-and-white.) The object returned from the <code>pkgcheck</code> function is a complex nested list with around a dozen primary components. Full information can be obtained by simply calling the default <code>print</code> method by typing the object name (<code>x</code>).</p>
</div>
<div id="caching-and-running-pkgcheck-in-the-background" class="section level2">
<h2 class="hasAnchor">
<a href="#caching-and-running-pkgcheck-in-the-background" class="anchor" aria-hidden="true"></a>Caching and running <code>pkgcheck</code> in the background</h2>
<p>Running the <a href="https://ropenscilabs.github.io/pkgcheck/reference/pkgcheck.html"><code>pgkcheck</code> function</a> can be time-consuming, primarily because the <a href="https://github.com/mangothecat/goodpractice" class="external-link"><code>goodpractice</code></a> component runs both a full <code>R CMD check</code>, and calculates code coverage of all tests. To avoid re-generating these results each time, the package saves previous reports to a local cache, in a <code>pkgcheck</code> subdirectory of the location determined by</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">rappdirs</span><span class="fu">::</span><span class="fu"><a href="https://rappdirs.r-lib.org/reference/user_cache_dir.html" class="external-link">user_cache_dir</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>You may manually erase the contents of this subdirectory at any time at no risk beyond additional time required to re-generate contents. This default location may also be over-ridden by setting an environmental variable named <code>pkgcheck_cache_dir</code>. By default checks presume packages use <code>git</code> for version control, with checks updated only when code is updated via <code>git commit</code>. Checks for packages that do not use <code>git</code> are updated when any files are modified.</p>
<p>The first time <a href="https://ropenscilabs.github.io/pkgcheck/reference/pkgcheck.html"><code>pkgcheck()</code></a> is applied to a package, the checks will be stored in the cache directory. Calling that function a second time will then load the cached results, and so enable checks to be returned much faster. For code which is frequently updated, such as for packages working on the final stages prior to submission, it may still be necessary to repeatedly call <a href="https://ropenscilabs.github.io/pkgcheck/reference/pkgcheck.html"><code>pkgcheck()</code></a> after each modification, a step which may still be inconveniently time-consuming. To facilitate frequent re-checking, the package also has a <a href="https://ropenscilabs.github.io/pkgcheck/reference/pkgcheck_bg.html"><code>pkgcheck_bg()</code> function</a> which is effectively identical to the main <a href="https://ropenscilabs.github.io/pkgcheck/reference/pkgcheck.html"><code>pkgcheck()</code> function</a>, except it runs in the background, enabling you to continue coding while checks are running.</p>
<p>The <a href="https://ropenscilabs.github.io/pkgcheck/reference/pkgcheck_bg.html"><code>pkgcheck_bg()</code> function</a> returns a handle to the <a href="https://callr.r-lib.org/reference/r_bg.html" class="external-link"><code>callr::r_bg()</code> process</a> in which the checks are running. Typing the name of the returned object will immediately indicate whether the checks are still running, or whether they have finished. That handle is itself an <a href="http://r6.r-lib.org/" class="external-link"><code>R6</code> object</a> with a number of methods, notably including <a href="https://callr.r-lib.org/reference/get_result.html" class="external-link"><code>get_result()</code></a> which can be used to access the checks once the process has finished. Alternatively, as soon as the background process, the normal (foreground) <a href="https://ropenscilabs.github.io/pkgcheck/reference/pkgcheck.html"><code>pkgcheck()</code> function</a> may be called to quickly re-load the cached results.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/ropenscilabs/pkgcheck/">https://​github.com/​ropenscilabs/​pkgcheck/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/ropenscilabs/pkgcheck/issues">https://​github.com/​ropenscilabs/​pkgcheck/​issues</a>
</li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></li>
</ul>
</div>


<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Mark Padgham <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/ropenscilabs/pkgcheck/actions?query=workflow%3AR-CMD-check" class="external-link"><img src="https://github.com/ropenscilabs/pkgcheck/workflows/R-CMD-check/badge.svg" alt="R build status"></a></li>
<li><a href="https://github.com/ropenscilabs/pkgcheck/actions?query=workflow%3Apush-to-gitlab" class="external-link"><img src="https://github.com/ropenscilabs/pkgcheck/workflows/push-to-gitlab/badge.svg" alt="gitlab push"></a></li>
<li><a href="https://www.repostatus.org/#concept" class="external-link"><img src="https://www.repostatus.org/badges/latest/concept.svg" alt="Project Status: Concept"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Mark Padgham.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
